<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="./style/favorito.css">
    <link rel="stylesheet" href="./style/carrinho.css">
    <link rel="icon" href="./imagem/Logo-icon1.png">
    <title>Favoritos SportMax</title>
</head>
<body>
    <header>
    <div class="barra-inicial">
        <nav>
            <a href="./login.html" id="login-link">Entrar</a>   |
            <a href="./ajuda.html">Ajuda</a>  |
            <a href="./sobreNos.html">Sobre Nós</a> |
            <a href="./produto.html">Produtos</a>
        </nav>
    </div>
 
    <div class="cabecalho">
        <div class="logo">
            <a href="./index.html"><img src="./imagem/Logo.png" alt="Logo SportMax" class="logo__img" loading="lazy"></a>
        </div>
 
        <div class="botao__categorias">
            <a href="./atalho_roupa.html">Roupas</a>
            <a href="./atalho_calcado.html">Calçados</a>
            <a href="./atalho_esporte.html">Esportes</a>
            <a href="./atalho_futebol.html">Futebol</a>
            <a href="./atalho_basquete.html">Basquete</a>
            <a href="./atalho_corrida.html">Corrida</a>
        </div>
       
        <div class="container-direita">
            <input id="busca" class="botao__pesquisa" type="search" placeholder="Buscar" aria-label="Campo de busca de produtos" />

            <a href="./favorito.html">
                <i class="fa-solid fa-heart" aria-hidden="true"></i>
            </a>

            <a href="javascript:void(0)" onclick="toggleCart()" class="link-carrinho" aria-label="Abrir carrinho">
                <i class="fa-solid fa-cart-shopping" aria-hidden="true"></i>
                <span id="cartCount" class="cart-count" aria-hidden="true">0</span>
            </a>

            <div class="menu-hamburguer" onclick="abrirMenu()">
                <i class="fa-solid fa-bars"></i>
            </div>
        </div>
         
        <div id="menu-lateral" class="menu-lateral">
            <div class="menu-entrar">
                <button class="botao-entrar">Entrar</button>
            </div>
           
        <ul>
            <li><a href="./atalho_roupa.html">Roupas</a></li>
            <li><a href="./atalho_calcado.html">Calçados</a></li>
            <li><a href="./atalho_esporte.html">Esportes</a></li>
            <li><a href="./atalho_futebol.html">Futebol</a></li>
            <li><a href="./atalho_basquete.html">Basquete</a></li>
            <li><a href="./atalho_corrida.html">Corrida</a></li>
        </ul>
 
        <ul>
            <li><a href="./ajuda.html">Ajuda</a></li>
            <li><a href="./produto.html">Produtos</a></li>
            <li><a href="./sobreNos.html">Sobre nós</a></li>
        </ul>
 
        </div>
 
        <div id="menu-overlay" class="menu-overlay" onclick="fecharMenu()"></div>
 
    </div>
</header>

    <h1 class="titulo">Favoritos</h1>

    <section class="produtos">
    <!-- Cards serão gerados pelo JS -->
    </section>


    <!-- Carrinho -->
    <div class="carrinho" id="cartSidebar">
    <div class="carrinho-cabecalho">
        <h3>Seu Carrinho</h3>
        <button class="fechar-carrinho" onclick="toggleCart()">✕</button>
    </div>
    <div class="items-carrinho" id="cartItems">
        <p class="carrinho-vazio">Seu carrinho está vazio</p>
    </div>
    <div class="carrinho-rodape">
        <div class="carrinho-total">
            <strong>Total: R$ <span id="cartTotal">0,00</span></strong>
        </div>
        <button class="finalizar-btn" onclick="checkout()">Finalizar Compra</button>
    </div>
</div>
<div class="sobreposicao-carrinho" id="cartOverlay" onclick="toggleCart()"></div>

    <footer>
        <div class="conatainer-footer">
            <div>
                <h3>Políticas</h3>
                <ul>
                    <li><a href="./TermosECondicoes.html">Política de Privacidade</a></li>
                    <li><a href="./TermosECondicoes.html">Política de Pagamento</a></li>
                    <li><a href="./TermosECondicoes.html">Termos e Condições</a></li>
                    <li><a href="./TermosECondicoes.html">Termos de Uso</a></li>
                </ul>
            </div>
            <div>
                <h3>Ajuda</h3>
                <ul>
                    <li><a href="./ajuda.html">Perguntas Frequentes</a></li>
                    <li><a href="./ajuda.html">Relatar Problema</a></li>
                    <li><a href="./ajuda.html">Dúvidas Gerais</a></li>
                    <li><a href="#">Quem somos</a></li>
                    <li><a href="./ajuda.html">Devoluções</a></li>
                </ul>
            </div>
            <div class="contato-footer">
                <h3>Contato</h3>
                <p>contato@sportmax.com.br</p>
                <p>(19) 99725-0283</p>
            </div>
            <div class="redes">
                <div class="rede-sociais">
                    <h3>Redes Sociais</h3>
                    <div class="icon-redes">
                        <a href="#" class="instagram"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="facebook"><i class="fab fa-facebook"></i></a>
                        <a href="#" class="youtube"><i class="fab fa-youtube"></i></a>
                        <a href="#" class="Linkedin"><i class="fab fa-linkedin"></i></a>
                    </div>
                </div>
            </div>
        </div>
        <div class="pagamento-footer">
            <div class="pagamento">
                <h3>Formas de Pagamento</h3>
                <div class="icon_pagamento">
                    <img src="./imagem/pagina_inicial/mastercard.png" alt="Mastercard" />
                    <img src="./imagem/pagina_inicial/LogoHipercard.webp" alt="Hipercard" />
                    <img src="./imagem/pagina_inicial/LogoPix.png" alt="Pix" />
                    <img src="./imagem/pagina_inicial/LogoVisa.png" alt="Visa" />
                    <img src="./imagem/pagina_inicial/Logo-Elo.webp" alt="Elo">
                </div>
            </div>
        </div>
        <p class="direitos">© 2025 SportMax. Todos os direitos reservados.</p>
    </footer>
    
<script src="./JavaScript/carrinho.js"></script>
<script>

//login
document.addEventListener('DOMContentLoaded', () => {
    const nome = localStorage.getItem('nome');
    const loginLink = document.getElementById('login-link');

    if (nome && loginLink) {
        const primeiroNome = nome.split(' ')[0];

        loginLink.outerHTML = `
            <div id="user-container" style="position: relative; display: inline-block;">
                <a href="javascript:void(0)" id="user-name">
                    <i class="fa fa-user"></i> Olá, ${primeiroNome}
                </a>
                <div id="user-menu">
                    <a href="./perfil.html" class="Perfil"><i class="fa fa-user"></i>Perfil</a>
                    <hr>
                    <button id="logout-btn"><i class="fa-solid fa-right-from-bracket"></i>Sair</button>
                </div>
            </div>
        `;

        const userName = document.getElementById('user-name');
        const userMenu = document.getElementById('user-menu');
        const logoutBtn = document.getElementById('logout-btn');

        // Mostra/oculta o menu quando clicar no nome
        userName.addEventListener('click', () => {
            userMenu.style.display = userMenu.style.display === 'flex' ? 'none' : 'flex';
        });

        // Fecha o menu se clicar fora dele
        document.addEventListener('click', (e) => {
            if (!userName.contains(e.target) && !userMenu.contains(e.target)) {
                userMenu.style.display = 'none';
            }
        });

        // Função de logout
        logoutBtn.addEventListener('click', () => {
            localStorage.removeItem('token');
            localStorage.removeItem('nome');
            window.location.reload();
        });
    }
});

document.addEventListener("DOMContentLoaded", () => {
    const containerProdutos = document.querySelector(".produtos");

    function atualizarMensagemVazio() {
        const listaFav = JSON.parse(localStorage.getItem("favoritos")) || [];
        let mensagemVazio = document.querySelector(".mensagem-vazio");

        if (listaFav.length === 0) {
            if (!mensagemVazio) {
                const div = document.createElement("div");
                div.classList.add("mensagem-vazio");
                div.innerText = "Nenhum produto nos favoritos";
                div.style.textAlign = "center";
                div.style.padding = "2rem";
                div.style.fontSize = "1.2rem";
                containerProdutos.appendChild(div);
            }
        } else {
            if (mensagemVazio) mensagemVazio.remove();
        }
    }

    function criarCardFav(produto) {
        const card = document.createElement("div");
        card.classList.add("card");

        card.innerHTML = `
            <div class="imagem__favorito">
                <i class="fa-solid fa-heart"></i>
                <img src="${produto.imagem}" alt="${produto.nome}" loading="lazy">
            </div>
            <div>
                <h1>${produto.nome}</h1>
                <span>${produto.preco}</span>
                <button class="btn-carrinho">Adicionar ao carrinho</button>
            </div>
        `;

        const coracao = card.querySelector("i");
        coracao.addEventListener("click", e => {
            e.stopPropagation();
            let lista = JSON.parse(localStorage.getItem("favoritos")) || [];
            const index = lista.findIndex(p => p.nome === produto.nome);
            if (index > -1) {
                lista.splice(index, 1);
                localStorage.setItem("favoritos", JSON.stringify(lista));
                card.remove();               // remove card do DOM imediatamente
                atualizarMensagemVazio();    // mostra mensagem se a lista ficar vazia
            }
        });

        containerProdutos.appendChild(card);
    }

    function carregarFavoritos() {
        containerProdutos.innerHTML = ""; 
        const listaFav = JSON.parse(localStorage.getItem("favoritos")) || [];
        if (listaFav.length === 0) {
            atualizarMensagemVazio();
        } else {
            listaFav.forEach(produto => criarCardFav(produto));
        }
    }

    // Chamada inicial apenas na página de favoritos
    if (window.location.pathname.includes("favorito")) {
        carregarFavoritos();
    }
});

//Hamburguer Menu
 
function abrirMenu() {
  document.getElementById("menu-lateral").classList.add("aberto");
  document.getElementById("menu-overlay").classList.add("ativo");
}
 
function fecharMenu() {
  document.getElementById("menu-lateral").classList.remove("aberto");
  document.getElementById("menu-overlay").classList.remove("ativo");
}
 
document.addEventListener('DOMContentLoaded', () => {
    const nome = localStorage.getItem('nome');
    const menuEntrar = document.querySelector('.menu-entrar');

    if (nome && menuEntrar) {
        const primeiroNome = nome.split(' ')[0];

        menuEntrar.innerHTML = `
            <div class="mobile-user-area">
                <button id="mobile-user-button" class="mobile-user-btn">
                    <i class="fa-regular fa-user"></i>
                    <span>Olá, ${primeiroNome}</span>
                    <i class="fa-solid fa-chevron-down seta-mobile"></i>
                </button>

                <div id="mobile-user-menu" class="mobile-user-dropdown">
                    <a href="./perfil.html">
                        <i class="fa-regular fa-user"></i> Perfil
                    </a>
                    <button id="mobile-logout-btn">
                        <i class="fa-solid fa-right-from-bracket"></i> Sair
                    </button>
                </div>
            </div>
        `;

        const btn = document.getElementById('mobile-user-button');
        const dropdown = document.getElementById('mobile-user-menu');
        const seta = document.querySelector('.seta-mobile');
        const logoutBtn = document.getElementById('mobile-logout-btn');

        btn.addEventListener('click', () => {
            dropdown.classList.toggle('open');
            seta.classList.toggle('girar');
        });

        logoutBtn.addEventListener('click', () => {
            localStorage.clear();
            window.location.reload();
        });
    }
});

// Função global para abrir login
function entrarConta() {
    window.location.href = "./login.html";
}

// Adiciona o evento ao botão do menu hambúrguer
document.addEventListener('DOMContentLoaded', () => {
    const botaoEntrarHamburguer = document.querySelector('.menu-entrar .botao-entrar');
    if (botaoEntrarHamburguer) {
        botaoEntrarHamburguer.addEventListener('click', entrarConta);
    }
});

// CARRINHO
initCartButtons(); // ativa os botões "Adicionar ao carrinho"
</script>

</body>
</html>